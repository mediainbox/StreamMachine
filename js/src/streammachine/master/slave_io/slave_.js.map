{
  "version": 3,
  "file": "slave_.js",
  "sourceRoot": "../../../../../src/streammachine/master/slave_io/",
  "sources": [
    "slave_.coffee"
  ],
  "names": [],
  "mappings": "AAEE,IAAA;;AAAA,MAAM,CAAC,OAAP,GAAuB,kBAAN,MAAA,gBAAA,QAA8B,OAAA,CAAQ,QAAR,CAAiB,CAAC,aAAhD;EACd,WAAa,IAAA,MAAA,CAAA;;IAAC,IAAC,CAAA;IAAI,IAAC,CAAA;IAGhB,IAAC,CAAA,EAAD,GAAkB,IAAC,CAAA,IAAI,CAAC;IACxB,IAAC,CAAA,WAAD,GAAkB;IAClB,IAAC,CAAA,QAAD,GAAkB;IAClB,IAAC,CAAA,YAAD,GAAkB,IAAI,IAAJ,CAAA,EAL1B;;IASQ,IAAC,CAAA,UAAD,GAAc,IAAC,CAAA,GAAG,CAAC,GAAG,CAAC,KAAT,CAAe;MAAA,KAAA,EAAM,IAAC,CAAA,IAAI,CAAC;IAAZ,CAAf;IACd,IAAC,CAAA,IAAI,CAAC,EAAN,CAAS,KAAT,EAAgB,CAAC,MAAM,CAAA,CAAP,CAAA,GAAA;aACZ,IAAC,CAAA,UAAU,CAAC,GAAG,CAAC,KAAJ,IAAW,OAAZ,CAAoB,CAAC,KAAhC,CAAsC,IAAC,CAAA,UAAvC,EAAmD,CAAC,GAAG,CAAC,GAAJ,IAAS,EAAV,EAAa,GAAG,CAAC,IAAJ,IAAU,CAAA,CAAvB,CAAnD;IADY,CAAhB,EAVR;;IAeQ,IAAC,CAAA,IAAI,CAAC,EAAN,CAAS,QAAT,EAAmB,CAAC,GAAD,EAAM,EAAN,CAAA,GAAA,EAAA;;aAEf,IAAC,CAAA,GAAG,CAAC,MAAM,CAAC,MAAZ,CAAmB,GAAnB,EAAwB,EAAxB;IAFe,CAAnB,EAfR;;IAoBQ,IAAC,CAAA,IAAI,CAAC,EAAN,CAAS,YAAT,EAAuB,CAAA,CAAA,GAAA;aACnB,IAAC,CAAA,iBAAD,CAAA;IADmB,CAAvB;EArBS,CAAjB;;;EA0BI,MAAQ,CAAC,EAAD,CAAA;WACJ,IAAC,CAAA,IAAI,CAAC,IAAN,CAAW,QAAX,EAAqB,CAAC,GAAD,EAAK,MAAL,CAAA,GAAA;MACjB,IAAC,CAAA,WAAD,GAAkB;MAClB,IAAC,CAAA,QAAD,GAAkB;aAElB,EAAA,CAAG,GAAH,EAAQ,MAAR;IAJiB,CAArB;EADI,CA1BZ;;;EAmCI,iBAAmB,CAAA,CAAA;AACvB,QAAA;IAAQ,SAAA,GAAY,IAAI,CAAC,KAAL,CAAY,CAAC,MAAA,CAAO,IAAI,IAAJ,CAAA,CAAP,CAAA,GAAqB,MAAA,CAAO,IAAC,CAAA,YAAR,CAAtB,CAAA,GAA+C,IAA3D;IACZ,IAAC,CAAA,GAAG,CAAC,GAAG,CAAC,KAAT,CAAe,CAAA,sBAAA,CAAA,CAAyB,IAAC,CAAA,IAAI,CAAC,EAA/B,CAAA,gBAAA,CAAA,CAAqD,SAArD,CAAA,SAAA,CAAf;WAEA,IAAC,CAAA,IAAD,CAAM,YAAN;EAJe;;AApCL",
  "sourcesContent": [
    "\r\n\r\nmodule.exports = class SlaveConnection extends require(\"events\").EventEmitter\r\n    constructor: (@sio,@sock) ->\r\n        super()\r\n\r\n        @id             = @sock.id\r\n        @last_status    = null\r\n        @last_err       = null\r\n        @connected_at   = new Date()\r\n\r\n        # -- wire up logging -- #\r\n\r\n        @socklogger = @sio.log.child slave:@sock.id\r\n        @sock.on \"log\", (obj = {}) =>\r\n            @socklogger[obj.level||'debug'].apply @socklogger, [obj.msg||\"\",obj.meta||{}]\r\n\r\n        # -- RPC Handlers -- #\r\n\r\n        @sock.on \"vitals\", (key, cb) =>\r\n# respond with the stream's vitals\r\n            @sio.master.vitals key, cb\r\n\r\n        # attach disconnect handler\r\n        @sock.on \"disconnect\", =>\r\n            @_handleDisconnect()\r\n\r\n#----------\r\n\r\n    status: (cb) ->\r\n        @sock.emit \"status\", (err,status) =>\r\n            @last_status    = status\r\n            @last_err       = err\r\n\r\n            cb err, status\r\n\r\n#----------\r\n\r\n    _handleDisconnect: ->\r\n        connected = Math.round( (Number(new Date()) - Number(@connected_at)) / 1000 )\r\n        @sio.log.debug \"Slave disconnect from #{@sock.id}. Connected for #{ connected } seconds.\"\r\n\r\n        @emit \"disconnect\"\r\n"
  ]
}