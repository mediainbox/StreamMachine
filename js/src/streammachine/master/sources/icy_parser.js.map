{
  "version": 3,
  "file": "icy_parser.js",
  "sourceRoot": "../../../../../src/streammachine/master/sources/",
  "sources": [
    "icy_parser.coffee"
  ],
  "names": [],
  "mappings": "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",
  "sourcesContent": [
    "module.exports = class IcyParser extends require(\"events\").EventEmitter\r\n        constructor: (type) ->\r\n            super()\r\n\r\n            @[\"INIT_\"+type]()\r\n            @offset = 0\r\n\r\n        @REQUEST:    \"REQUEST\"\r\n        @RESPONSE:   \"RESPONSE\"\r\n\r\n        reinitialize: @\r\n\r\n        execute: (@chunk) ->\r\n            @offset = 0\r\n            @end = @chunk.length\r\n\r\n            while @offset < @end\r\n                @[@state]()\r\n                @offset++;\r\n\r\n            true\r\n\r\n        INIT_REQUEST: ->\r\n            @state = \"REQUEST_LINE\"\r\n            @lineState = \"DATA\"\r\n            @info = headers:{}\r\n\r\n        consumeLine: ->\r\n            @captureStart = @offset if !@captureStart?\r\n\r\n            byte = @chunk[@offset]\r\n            if byte == 0x0d && @lineState == \"DATA\" # \\r\r\n                @captureEnd = @offset\r\n                @lineState = \"ENDING\"\r\n                return\r\n\r\n            if @lineState == \"ENDING\"\r\n                @lineState = \"DATA\"\r\n                return if byte != 0x0a\r\n\r\n                line = @chunk.toString \"ascii\", @captureStart, @captureEnd\r\n\r\n                @captureStart = undefined\r\n                @captureEnd = undefined\r\n\r\n                return line\r\n\r\n        requestExp: /^([A-Z]+) (.*) (ICE|HTTP)\\/(1).(0|1)$/;\r\n\r\n        REQUEST_LINE: ->\r\n            line = @consumeLine()\r\n\r\n            return if !line?\r\n\r\n            match = @requestExp.exec line\r\n\r\n            if match\r\n                [@info.method,@info.url,@info.protocol,@info.versionMajor,@info.versionMinor] = match[1..5]\r\n            else\r\n                # this isn't a request line that we understand... we should\r\n                # close the connection\r\n                @emit \"invalid\"\r\n\r\n            @info.request_offset = @offset\r\n            @info.request_line = line\r\n\r\n            @state = \"HEADER\"\r\n\r\n        headerExp: /^([^:]+): *(.*)$/\r\n\r\n        HEADER: ->\r\n            line = @consumeLine()\r\n\r\n            return if !line?\r\n\r\n            if line\r\n                match = @headerExp.exec line\r\n                @info.headers[match[1].toLowerCase()] = match[2]\r\n            else\r\n                @emit \"headersComplete\", @info.headers\r\n"
  ]
}