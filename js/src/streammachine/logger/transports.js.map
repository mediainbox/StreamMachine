{
  "version": 3,
  "file": "transports.js",
  "sourceRoot": "../../../../src/streammachine/logger/",
  "sources": [
    "transports.coffee"
  ],
  "names": [],
  "mappings": "AAAA,IAAA,cAAA,EAAA,SAAA,EAAA,CAAA,EAAA,KAAA,EAAA,EAAA,EAAA;;AAAA,EAAA,GAAc,OAAA,CAAQ,IAAR;;AACd,IAAA,GAAc,OAAA,CAAQ,MAAR;;AACd,SAAA,GAAc,OAAA,CAAQ,mBAAR;;AACd,KAAA,GAAQ,OAAA,CAAQ,OAAR;;AACR,CAAA,GAAI,OAAA,CAAQ,QAAR;;AAEE;EAAN,MAAA,eAAA,QAA6B,UAA7B;IAGI,WAAa,CAAC,IAAD,CAAA;WACT,CAAM,IAAN;MACA,IAAC,CAAA,SAAD,GAAa,OAAA,CAAQ,OAAR,CAAA,CAAiB,QAAjB;MACb,IAAC,CAAA,UAAD,GAAc,CAAA;IAHL;;IAKb,UAAY,CAAC,IAAD,CAAA;AAChB,UAAA,SAAA,EAAA,UAAA,EAAA,EAAA,EAAA;MAAQ,CAAA,CAAE,QAAF,EAAY,SAAZ,CAAA,GAA0B,IAA1B;MAEA,IAAI,CAAC,SAAL;AACI,eAAO,IAAC,CAAA,UADZ;;MAGA,UAAA,GAAa,KAAA,GAAQ,SAAR,GAAoB,CAAI,QAAH,GAAiB,CAAA,EAAA,CAAA,CAAK,QAAL,CAAA,CAAA,CAAjB,GAAuC,EAAxC;MACjC,EAAA,GAAK,IAAC,CAAA,UAAU,CAAC,UAAD;MAEhB,IAAI,CAAC,EAAL;QACI,EAAA,GAAK,KAAA,CAAM,UAAN;QACL,IAAC,CAAA,UAAU,CAAC,UAAD,CAAX,GAA0B,GAF9B;;AAIA,aAAO;IAbC;;IAeZ,GAAK,CAAC,IAAD,EAAO,QAAP,CAAA;AACT,UAAA,SAAA,EAAA,EAAA,EAAA,KAAA,EAAA,OAAA,EAAA,IAAA,EAAA,SAAA,EAAA;MAAQ,CAAA,CAAE,KAAF,EAAS,OAAT,EAAkB,SAAlB,EAA6B,QAA7B,EAAuC,GAAA,IAAvC,CAAA,GAAmD,IAAnD;MACA,EAAA,GAAK,IAAC,CAAA,UAAD,CAAY,IAAZ;MAEL,SAAA,GAAY,CAAC,CAAC,MAAF,CAAS,IAAT,EAAc,QAAA,CAAC,KAAD,EAAQ,GAAR,CAAA;AAAgB,eAAO,OAAO,GAAP,KAAc;MAArC,CAAd;MAEZ,EAAA,CAAG,CAAA,CAAA,CAAA,CAAI,KAAJ,CAAA,EAAA,CAAA,CAAc,OAAd,CAAA,CAAH,EAA4B,SAA5B;aACA,QAAA,CAAS,IAAT,EAAe,IAAf;IAPC;;EAvBT;;2BACI,IAAA,GAAM;;;;;;AAgCV,MAAM,CAAC,OAAP,GACI;EAAA,cAAA,EAAgB;AAAhB",
  "sourcesContent": [
    "fs          = require \"fs\"\r\npath        = require \"path\"\r\nTransport   = require('winston-transport')\r\ndebug = require(\"debug\")\r\n_ = require \"lodash\"\r\n\r\nclass DebugTransport extends Transport\r\n    name: \"debug\"\r\n\r\n    constructor: (opts) ->\r\n        super opts\r\n        @defaultFn = require(\"debug\")(\"sm:log\")\r\n        @debugFnMap = {}\r\n\r\n    getDebugFn: (info) ->\r\n        { workerId, component } = info\r\n\r\n        if (!component)\r\n            return @defaultFn\r\n\r\n        debugLabel = 'sm:' + component + (if workerId then \"(w#{workerId})\" else '')\r\n        fn = @debugFnMap[debugLabel]\r\n\r\n        if (!fn)\r\n            fn = debug(debugLabel)\r\n            @debugFnMap[debugLabel] = fn\r\n\r\n        return fn\r\n\r\n    log: (info, callback) ->\r\n        { level, message, component, workerId, meta... } = info\r\n        fn = @getDebugFn(info)\r\n\r\n        metaToLog = _.pickBy(meta,(value, key) -> return typeof key != 'symbol')\r\n\r\n        fn(\"[#{level}] #{message}\", metaToLog)\r\n        callback null, true\r\n\r\n\r\nmodule.exports =\r\n    DebugTransport: DebugTransport\r\n"
  ]
}