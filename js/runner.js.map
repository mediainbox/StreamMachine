{
  "version": 3,
  "file": "runner.js",
  "sourceRoot": "../",
  "sources": [
    "runner.coffee"
  ],
  "names": [],
  "mappings": "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",
  "sourcesContent": [
    "# Runner is a process manager that allows StreamMachine instances to live\r\n# restart, transferring state between old and new processes.\r\n\r\ndebug = require(\"debug\")(\"sm:runner\")\r\n\r\npath    = require \"path\"\r\nfs      = require \"fs\"\r\ncp      = require \"child_process\"\r\nWatch   = require \"watch-for-path\"\r\n\r\nargs = require(\"yargs\")\r\n    .usage(\"Usage: $0 --watch [watch file] --title [title] --config [streammachine config file]\")\r\n    .describe\r\n        watch:      \"File to watch for restarts\"\r\n        title:      \"Process title suffix\"\r\n        restart:    \"Trigger handoff if watched path changes\"\r\n        config:     \"Config file to pass to StreamMachine\"\r\n        dir:        \"Directory path for StreamMachine\"\r\n        coffee:     \"Run via coffeescript\"\r\n    .default\r\n        restart:    true\r\n        coffee:     false\r\n    .demand(['config'])\r\n    .argv\r\n\r\nclass StreamMachineRunner extends require(\"events\").EventEmitter\r\n    constructor: (@_streamer,@_args) ->\r\n        super()\r\n\r\n        @process        = null\r\n        @_terminating   = false\r\n        @_inHandoff     = false\r\n\r\n        @_command = \"#{@_streamer} --config=#{@_args.config}\"\r\n\r\n        process.title =\r\n            if @_args.title\r\n                \"StreamR:#{@_args.title}\"\r\n            else\r\n                \"StreamR\"\r\n\r\n        if @_args.watch\r\n            console.error \"Setting a watch on #{ @_args.watch } before starting up.\"\r\n\r\n            new Watch @_args.watch, (err) =>\r\n                throw err if err\r\n\r\n                debug \"Found #{ @_args.watch }. Starting up.\"\r\n\r\n                if @_args.restart\r\n                    # now set a normal watch on the now-existant path, so that\r\n                    # we can restart if it changes\r\n                    @_w = fs.watch @_args.watch, (evt,file) =>\r\n                        debug \"fs.watch fired for #{@_args.watch} (#{evt})\"\r\n                        @emit \"_restart\"\r\n\r\n                    last_m = null\r\n                    @_wi = setInterval =>\r\n                        fs.stat @_args.watch, (err,stats) =>\r\n                            return false if err\r\n\r\n                            if last_m\r\n                                if Number(stats.mtime) != last_m\r\n                                    debug \"Polling found change in #{@_args.watch}.\"\r\n                                    @emit \"_restart\"\r\n                                    last_m = Number(stats.mtime)\r\n\r\n                            else\r\n                                last_m = Number(stats.mtime)\r\n\r\n                    , 1000\r\n\r\n                # path now exists...\r\n                @_startUp()\r\n\r\n                last_restart = null\r\n                @on \"_restart\", =>\r\n                    cur_t = Number(new Date)\r\n                    if @process? && (!last_restart || cur_t - last_restart > 1200)\r\n                        last_restart = cur_t\r\n                        # send a kill, then let our normal exit code handle the restart\r\n                        debug \"Triggering restart after watched file change.\"\r\n                        @restart()\r\n        else\r\n            @_startUp()\r\n\r\n    #----------\r\n\r\n    _startUp: ->\r\n        _start = =>\r\n            @process = @_spawn(false)\r\n            debug \"Startup process PID is #{ @process.p.pid }.\"\r\n\r\n        if !@process\r\n            _start()\r\n        else\r\n            # we expect the process to be shut down\r\n            try\r\n                # signal 0 tests whether process exists\r\n                process.kill worker.pid, 0\r\n\r\n                # if we get here we've failed\r\n                debug \"Tried to start command while it was already running.\"\r\n            catch e\r\n                # not running... start a new one\r\n\r\n                @process.p.removeAllListeners()\r\n                @process.p = null\r\n\r\n                uptime = Number(new Date) - @process.start\r\n                debug \"Command uptime was #{ Math.floor(uptime / 1000) } seconds.\"\r\n\r\n                _start()\r\n\r\n    #----------\r\n\r\n    _spawn: (isHandoff=false) ->\r\n        debug \"Should start command: #{@_command}\"\r\n\r\n        cmd = @_command.split(\" \")\r\n\r\n        if isHandoff\r\n            cmd.push \"--handoff\"\r\n\r\n        # FIXME: Are there any opts we would want to pass?\r\n        opts = {}\r\n\r\n        process = p:null, start:Number(new Date), stopping:false\r\n        process.p = cp.fork cmd[0], cmd[1..], opts\r\n\r\n        #process.p.stderr.pipe(process.stderr)\r\n\r\n        process.p.once \"error\", (err) =>\r\n            debug \"Command got error: #{err}\"\r\n            @_startUp() if !process.stopping\r\n\r\n        process.p.once \"exit\", (code,signal) =>\r\n            debug \"Command exited: #{code} || #{signal}\"\r\n            @_startUp() if !process.stopping\r\n\r\n        process\r\n\r\n    #----------\r\n\r\n    restart: ->\r\n        # For restart, we need to stash our existing process and start a new\r\n        # one with the --handoff flag. We then connect the message channels of\r\n        # the two and let them run the handoff. When the old process exits,\r\n        # our handoff is complete and we can install the new process as our\r\n        # main process.\r\n\r\n        if !@process || @process.stopping\r\n            console.error \"Restart triggered with no process running.\"\r\n            return\r\n\r\n        if @_inHandoff\r\n            console.error \"Restart triggered while in existing handoff.\"\r\n            return\r\n\r\n        @_inHandoff = true\r\n\r\n        # grab our existing process\r\n        old_process = @process\r\n        @process.stopping = true\r\n\r\n        new_process = @_spawn(true)\r\n\r\n        handles = []\r\n\r\n        # proxy messages between old and new\r\n        aToB = (title,a,b) =>\r\n            (msg,handle) =>\r\n                debug \"Message: #{title}\", msg, handle?\r\n\r\n                if handle && handle.destroyed\r\n                    # lost handle mid-flight... send message without it\r\n                    b.send msg\r\n                else\r\n                    try\r\n                        b.send msg, handle\r\n                        handles.push handle if handle?\r\n                    catch e\r\n                        if e instanceOf TypeError\r\n                            console.error \"HANDLE SEND ERROR:: #{err}\"\r\n\r\n                            # send without the handle\r\n                            b.send msg\r\n\r\n        oToN = aToB(\"Old -> New\",old_process.p,new_process.p)\r\n        nToO = aToB(\"New -> Old\",new_process.p,old_process.p)\r\n\r\n        old_process.p.on \"message\", oToN\r\n        new_process.p.on \"message\", nToO\r\n\r\n        # watch for the old instance to die\r\n        old_process.p.once \"exit\", =>\r\n            # detach our proxies\r\n            new_process.p.removeListener \"message\", nToO\r\n            debug \"Handoff completed.\"\r\n\r\n            for h in handles\r\n                h.close?()\r\n\r\n            @process = new_process\r\n            @_inHandoff = false\r\n\r\n        # send SIGUSR2 to start the process\r\n        process.kill old_process.p.pid, \"SIGUSR2\"\r\n\r\n    #----------\r\n\r\n    terminate: (cb)->\r\n        @_terminating = true\r\n\r\n        if @process\r\n            @process.stopping = true\r\n            @process.p.once \"exit\", =>\r\n                debug \"Command is stopped.\"\r\n\r\n                uptime = Number(new Date) - @process.start\r\n                debug \"Command uptime was #{ Math.floor(uptime / 1000) } seconds.\"\r\n\r\n                @process = null\r\n                cb()\r\n\r\n            @process.p.kill()\r\n        else\r\n            debug \"Stop called with no process running?\"\r\n            cb()\r\n\r\n#----------\r\n\r\n# This is to enable running in dev via coffee. Is it foolproof? Probably not.\r\n\r\nstreamer_path =\r\n    if args.coffee\r\n        path.resolve(args.dir||__dirname,\"./coffee.js\")\r\n    else\r\n        if args.dir\r\n            path.resolve(args.dir,\"js/streamer.js\")\r\n        else\r\n            path.resolve(__dirname,\"./streamer.js\")\r\n\r\ndebug \"Streamer path is #{streamer_path}\"\r\n\r\nrunner = new StreamMachineRunner streamer_path, args\r\n\r\n\r\n_handleExit = ->\r\n    runner.terminate ->\r\n        debug \"StreamMachine Runner exiting.\"\r\n        process.exit()\r\n\r\nprocess.on 'SIGINT',    _handleExit\r\nprocess.on 'SIGTERM',   _handleExit\r\n\r\nprocess.on 'SIGHUP', ->\r\n    debug \"Restart triggered via SIGHUP.\"\r\n    runner.restart()\r\n"
  ]
}